(function(a){a.fn.retinafy=function(b){target=a(this);if(window.devicePixelRatio>=2){if(b!==null){var c=target.find("*").andSelf().filter(function(){return a(this).is("img")||a(this).css("backgroundImage")!=="none"});for(i=0;i<c.length;i++){var d=c[i];var e=a(d).width();var f=a(d).height();var g=a(d).attr("src");var h=a(d).css("background-image");function j(a){if(!(!a.match(/^https?\:/i)||a.match("//"+document.domain))){return false}else{var b=new XMLHttpRequest;b.open("HEAD",a,false);b.send();return b.status!=404}}if(a(d).is("img")&&g.indexOf("@2x")==-1){var k=g.lastIndexOf(".");if(k!=-1){g=g.substr(0,k)+"@2x"+g.substr(k)}if(j(g)){a(d).attr("src",g);a(d).attr("width",e).height("height",f)}}else if(h!=="none"&&h.indexOf("@2x")==-1){var l=h;var k=l.lastIndexOf(".");if(k!=-1){l=l.substr(0,k)+"@2x"+l.substr(k)}var m=l;var m=m.substr(4);var m=m.substr(0,m.length-1);if(j(m)){a(d).css("background-image",l)}}}}return true}else{return false}}})(jQuery)